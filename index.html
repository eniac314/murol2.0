<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Main</title>
  
  
  <script src="https://unpkg.com/@webcomponents/webcomponentsjs@2.0.0/webcomponents-bundle.js" type="text/javascript"></script>
  <script type="text/javascript" src="js/Editor.js"></script>
  <script type='text/javascript' src='js/PortFunnel.js'></script>


</head>


  

<body>

  <script type="text/javascript">
    var app = Elm.Editor.init();

    // PortFunnel.subscribe will load js/PortFunnel/<module>.js,
    // for each module in this list.
    var modules = ['LocalStorage'];

    PortFunnel.subscribe(app, {modules: modules});

    customElements.define('custom-textarea', class extends HTMLElement {
    
	    constructor(){
	      super();
	      
	    }
	    
	    get selection(){
	    	return this._currentSelection || "no selection";	
	    }

        get cols(){
        	return this._cols || "0";
        }

        set selection(offset){
        	if(offset !== null) {
	        	this._textarea = this.querySelector('textarea');
	        	this._textarea.focus();
	        	this._textarea.setSelectionRange(offset.start,offset.stop);
	        }
        }

	    connectedCallback() {
	    	this._textarea = this.querySelector('textarea');
            
	    	this._textarea.addEventListener('click', (event) => {
            
            var start = this._textarea.selectionStart;
	    	var finish = this._textarea.selectionEnd;
	    	var sel = this._textarea.value.substring(start, finish);

            this._currentSelection = 
               { start: start, 
                 finish: finish,
                 sel: sel
               };

	    	this.dispatchEvent(new CustomEvent('Selection'));
	    	}); 
	    
	    }
    });
    
  </script>
  
  
</body>
</html>