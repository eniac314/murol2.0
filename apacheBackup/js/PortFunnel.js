!function(e){function n(e){if("object"==typeof e){var n=e.module,t=PortFunnel.modules[n];if(t){var s=t.cmd;if(s&&!u[n])return s(e.tag,e.args);var l=u[n];l||(l=[]),l.push(e),u[n]=l,o||r()}}}function r(){queueDrainOutStanding=!0,setTimeout(t,10)}function t(){for(var e in needReschedule=!1,u){var t=PortFunnel.modules[e];if(t){if(t.cmd){var s=u[e];for(var l in delete u[e],s){var a=n(s[l]);a&&PortFunnel.sub.send(a)}}else needReschedule=!0;needReschedule?r():o=!1}else delete u[e]}}PortFunnel={},e.PortFunnel=PortFunnel,PortFunnel.subscribe=function(e,r){r||(r={}),portNames=r.portNames,portNames||(portNames=["cmdPort","subPort"]);var t=e.ports,u=t[portNames[1]];PortFunnel.sub=u,t[portNames[0]].subscribe(function(e){var r=n(e);r&&u.send(r)})},PortFunnel.modules={},PortFunnel.sub=null;var u={},o=!1}(this);